# Story 1.1: Coin List View (Paginated)

## Status
Draft

## Story
**As a** user,
**I want** to see a list of the top cryptocurrencies with name, price, and market cap,
**so that** I can quickly assess market status and browse available coins with pagination support.

## Acceptance Criteria
1. The Coin List View (Paginated) feature works on mobile and desktop
2. Data is correctly fetched and rendered without crashing
3. Component updates in response to state changes (search, filter, input)
4. User receives feedback on loading and error scenarios
5. Feature passes all related unit tests and E2E flows

## Tasks / Subtasks
- [ ] Set up development tooling and code quality
  - [ ] Configure ESLint with Next.js, TypeScript, and React rules
  - [ ] Set up Prettier for consistent code formatting
  - [ ] Configure lint-staged and husky for pre-commit hooks
  - [ ] Ensure `npm run lint` and `npm run format` scripts work
  - [ ] All code must pass linting before commits
- [ ] Set up TypeScript configuration and type definitions
  - [ ] Ensure `tsconfig.json` is properly configured for Next.js 15
  - [ ] Create `/src/types/coingecko.ts` with API response interfaces (reference `docs/api-reference.md`)
  - [ ] Set up strict TypeScript rules for type safety
  - [ ] Configure TypeScript for components, hooks, and utilities
- [ ] Configure Next.js development server for flexible port assignment
  - [ ] Update `package.json` dev script to handle port conflicts
  - [ ] Configure Next.js to auto-increment ports (3000 → 3001 → 3002, etc.)
  - [ ] Ensure clear console output showing actual running port
- [ ] Create `CoinCard.tsx` component for individual coin display (AC: 1, 2)
  - [ ] Implement coin data display (name, symbol, price, market cap, 24h change)
  - [ ] Apply Tailwind CSS styling for responsive design
  - [ ] Define TypeScript interfaces for component props
  - [ ] Use proper TypeScript typing for coin data structure
- [ ] Create `useCoins.ts` custom hook for data fetching (AC: 2, 4)
  - [ ] Implement SWR for coin list data fetching using `/coins/markets` endpoint
  - [ ] Handle pagination parameters (page, per_page)
  - [ ] Implement error and loading states
- [ ] Create `Pagination.tsx` component (AC: 1, 3)
  - [ ] Implement pagination controls (next, previous, page numbers)
  - [ ] Handle pagination state management
  - [ ] Apply Tailwind styling for mobile/desktop
- [ ] Integrate components in `/src/app/page.tsx` (Home page) (AC: 1, 2, 3)
  - [ ] Compose CoinCard, Pagination, and useCoins hook
  - [ ] Handle loading and error UI states
  - [ ] Ensure responsive layout
- [ ] Create comprehensive unit tests (AC: 5)
  - [ ] Test CoinCard component rendering with mock data
  - [ ] Test CoinCard component handles missing/null data gracefully
  - [ ] Test useCoins hook functionality with SWR mocking
  - [ ] Test useCoins hook error states and loading states
  - [ ] Test Pagination component interactions and state changes
  - [ ] Test Pagination component edge cases (first/last page)
  - [ ] Test integration in page.tsx with mocked API responses
  - [ ] Ensure all tests pass with `npm run test` before story completion
- [ ] Verify test coverage and quality
  - [ ] Run `npm run test:coverage` to ensure adequate coverage
  - [ ] All tests must pass in CI/CD pipeline
  - [ ] Fix any failing tests before marking story as complete
- [ ] Code quality verification
  - [ ] Run `npm run lint` - all linting rules must pass
  - [ ] Run `npm run format:check` - all code must be properly formatted
  - [ ] Run `npm run type-check` - TypeScript compilation must succeed
  - [ ] Pre-commit hooks must be working and passing
- [ ] Follow git workflow standards
  - [ ] Commit frequently throughout development (see `docs/git-workflow.md`)
  - [ ] Use conventional commit format: `(feat)[coin-list-view] summary`
  - [ ] Ensure each commit passes all quality gates
- [ ] Create comprehensive README documentation
  - [ ] Project overview and purpose (reference PRD goals)
  - [ ] Tech stack and architecture overview
  - [ ] Installation and setup instructions (Node.js, dependencies)
  - [ ] Development commands (dev, build, test, lint)
  - [ ] API configuration (CoinGecko API key setup)
  - [ ] Project structure explanation
  - [ ] Testing instructions and coverage info
  - [ ] Deployment guidelines
  - [ ] Contributing guidelines (reference git-workflow.md)

## Dev Notes

### Previous Story Insights
No previous stories exist - this is the first story of the project.

### Tech Stack & Framework
[Source: architecture/technologies.md]
- **Framework**: Next.js 15 (App Router, Static Export)
- **Language**: TypeScript
- **Styling**: Tailwind CSS
- **Data Fetching**: SWR (stale-while-revalidate)
- **Testing**: Jest, React Testing Library, Cypress

### API Specifications
[Source: architecture/api-integration.md + docs/api-reference.md]
- **Base URL**: `https://api.coingecko.com/api/v3`
- **Headers**: `x-cg-demo-api-key` from `.env.local`
- **Rate Limit**: ~30 req/min (demo tier)
- **Primary Endpoint**: `/coins/markets` - Query all supported coins with price, market cap, volume and market related data
- **Full API Documentation**: See `docs/api-reference.md` for complete endpoint specifications, TypeScript interfaces, and implementation examples
- **Key Parameters**: 
  - `vs_currency=usd` (required)
  - `order=market_cap_desc` (sort by market cap)
  - `per_page=100` (pagination size)
  - `page=1` (page number)
  - `sparkline=false` (disable sparkline for list view)
- **Strategy**: Cache coin lists, fetch details per ID on-demand

### Component Specifications
[Source: architecture/high-level-architecture.md]
- **CoinCard.tsx**: Individual coin display component
- **Pagination.tsx**: Pagination controls component  
- **useCoins.ts**: Custom hook for coin data fetching

### File Locations
[Source: architecture/folder-structure.md, architecture/high-level-architecture.md]
- Components: `/src/components/`
- Hooks: `/src/hooks/`
- API utilities: `/src/lib/` (fetcher.ts, api.ts)
- Home page: `/src/app/page.tsx`
- Tests: `/src/tests/unit/` (Jest + RTL)

### Technical Constraints
[Source: architecture/key-architectural-decisions.md]
- **Client-side only**: Simplifies deployment, reduces SSR complexity
- **SWR over React Query**: Lightweight, perfect for read-heavy UIs
- **Composable hooks**: Encapsulate fetch + state in custom hooks
- **Atomic components**: Small UI building blocks, Tailwind-driven
- **Static export**: Fast CDN delivery, Next.js `output: export`
- **Minimal state management**: Avoid Redux/Jotai unless global state grows

### Code Quality & Formatting Configuration
- **ESLint**: 
  - Use `@next/eslint-config-next` as base configuration
  - Add `@typescript-eslint/eslint-plugin` for TypeScript rules
  - Include React and React Hooks rules
  - Configure import/export ordering rules
- **Prettier**:
  - Set up `.prettierrc` with consistent formatting rules
  - Configure 2-space indentation, single quotes, trailing commas
  - Integrate with ESLint using `eslint-config-prettier`
- **Pre-commit Hooks**:
  - Use `husky` for Git hooks
  - Use `lint-staged` to run formatters/linters on staged files
  - Ensure code is formatted and linted before commits
- **Scripts**: Must include `lint`, `lint:fix`, `format`, and `format:check`

### TypeScript Configuration
- **Version**: Use TypeScript 5.x compatible with Next.js 15
- **Config File**: Ensure `tsconfig.json` with strict mode enabled
- **Type Definitions**: Create `/src/types/coingecko.ts` for all API response types
- **Import Strategy**: Use proper TypeScript imports (`import type` for types)
- **Build Process**: Ensure TypeScript compilation works with `npm run build`
- **IDE Support**: Configure for proper IntelliSense and error detection

### Development Server Configuration
- **Port Assignment**: Configure Next.js to automatically find available ports (3000, 3001, 3002, etc.)
- **Setup Requirement**: Ensure `npm run dev` or `yarn dev` displays the actual port being used
- **Configuration**: Update `package.json` scripts or `next.config.js` to handle port conflicts gracefully
- **Console Output**: Must show clear message like "Ready on http://localhost:3001" when default port 3000 is occupied

### README Documentation Requirements
- **Professional Presentation**: README should enable new developers to run project within 5 minutes
- **Content Sources**: 
  - Project goals from `docs/prd/project-overview-goals.md`
  - Tech stack from `docs/architecture/technologies.md`
  - API setup from `docs/api-reference.md`
  - Git workflow from `docs/git-workflow.md`
- **Structure**: Use clear sections with proper markdown formatting
- **Environment Setup**: Include `.env.local` template with required variables
- **Troubleshooting**: Common setup issues and solutions

### Data Model Expectations
Based on CoinGecko `/coins/markets` API response structure:
```typescript
interface Coin {
  id: string;
  symbol: string;
  name: string;
  image: string;
  current_price: number;
  market_cap: number;
  market_cap_rank: number;
  price_change_percentage_24h: number;
  total_volume: number;
}
```

### Testing Requirements
[Source: architecture/technologies.md]
- **Unit Tests**: Jest + React Testing Library
- **Location**: `/src/tests/unit/` or `__tests__/` directories
- **E2E Tests**: Cypress (for future integration)
- **Location**: `/src/tests/e2e/`

#### Testing Standards & Requirements
- **Coverage Target**: Minimum 80% code coverage for components and hooks
- **Test Files**: Each component/hook must have corresponding `.test.tsx` or `.test.ts` file
- **Mocking Strategy**: 
  - Mock SWR with `swr/dist/mutation` for hook testing
  - Mock API responses using `msw` (Mock Service Worker) if available
  - Use `@testing-library/jest-dom` for DOM assertions
- **Test Categories Required**:
  - **Rendering Tests**: Component renders without crashing
  - **Props Tests**: Component handles different prop combinations
  - **Interaction Tests**: User interactions work correctly
  - **Error State Tests**: Components handle error states gracefully
  - **Loading State Tests**: Loading states display correctly
  - **Hook Tests**: Custom hooks return expected data/states
- **Quality Gates**: 
  - All tests must pass: `npm run test`
  - All linting rules must pass: `npm run lint`
  - Code must be properly formatted: `npm run format:check`
  - TypeScript compilation must succeed: `npm run type-check`
  - No console errors or warnings during test execution
  - Pre-commit hooks must be configured and working

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-08-04 | 1.0 | Initial story creation | Scrum Master (Bob) |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled by dev agent*

### Debug Log References
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results
*Results from QA Agent review will be populated here after implementation*